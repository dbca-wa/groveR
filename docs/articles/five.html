<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Dealing With Cloud • groveR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Dealing With Cloud">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">groveR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dbca-wa/groveR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Dealing With Cloud</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dbca-wa/groveR/blob/HEAD/vignettes/five.Rmd" class="external-link"><code>vignettes/five.Rmd</code></a></small>
      <div class="d-none name"><code>five.Rmd</code></div>
    </div>

    
    
<div class="float">
<img src="../reference/figures/tree_logo_small.png" alt="groveR logo"><div class="figcaption">groveR logo</div>
</div>
<div class="section level2">
<h2 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h2>
<p>Clouds are the bane of remote sensing studies. They obscure the
reflectance values of the end members we are interested in and if not
dealt with will skew results. When mosaicking multiple satellite scenes
together, inevitably there will be the odd year when including some
cloud or haze is unavoidable.</p>
<p><code>groveR</code> has a two step process for dealing with
clouds:</p>
<ul>
<li>Digitised clouds are converted to masks with the appropriate extents
and pixel size for your data using <code><a href="../reference/make_mask.html">make_mask()</a></code>.</li>
<li>Clouds are then accounted for in the correct annual mosaic using
<code><a href="../reference/cloud_mask.html">cloud_mask()</a></code> which encodes the spatial location so that
they can either be omitted from the analysis entirely or form part of a
fuzzy classification where a probable classification based on the prior
year’s data is constructed.</li>
</ul>
</div>
<div class="section level2">
<h2 id="use-the-make_mask-function">Use the make_mask() function<a class="anchor" aria-label="anchor" href="#use-the-make_mask-function"></a>
</h2>
<p>The user first familiarises themselves with the original mosaics,
identifies cloud or smoke haze, digitises a polygon around them and
saves the result as a shapefile. The shapefile must have an attribute
column called “year” which is populated with the 4 digit year that the
cloud was observed in. One shapefile can contain the digitised
boundaries of all clouds identified through the entire time series of
mosaics. The test data includes an example located at
<code>vectors/cloud_vectors.shp</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The general form of the function is (NOTE the default parameters)</span></span>
<span><span class="co"># make_mask(ivect, refimage, attribname = "year", loc ="raster_masks/cloud_masks")</span></span>
<span></span>
<span><span class="co"># We only need to assign the first 2 parameters as the defaults are fine</span></span>
<span><span class="va">ivect</span> <span class="op">&lt;-</span> <span class="st">"vectors/cloud_vectors.shp"</span></span>
<span><span class="va">refimage</span> <span class="op">&lt;-</span> <span class="st">"veg_dens/lgcsmp_lsat_vdens_2011.tif"</span></span>
<span></span>
<span><span class="co"># Run the function</span></span>
<span><span class="fu"><a href="../reference/make_mask.html">make_mask</a></span><span class="op">(</span><span class="va">ivect</span>, <span class="va">refimage</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<strong>ivect</strong> - input file path to cloud shapefile.</li>
<li>
<strong>refimage</strong> - file path to any raster that has been
created during processing thus far. The format of the raster is used as
a template to create the cloud masks.</li>
</ul>
</div>
<div class="section level2">
<h2 id="whats-going-to-happen">What’s going to happen?<a class="anchor" aria-label="anchor" href="#whats-going-to-happen"></a>
</h2>
<p>One cloud mask for each unique year found in the attribute column of
the cloud shapefile will be written to
<code>raster_masks/cloud_masks/</code>.</p>
</div>
<div class="section level2">
<h2 id="use-the-cloud_mask-function">Use the cloud_mask() function<a class="anchor" aria-label="anchor" href="#use-the-cloud_mask-function"></a>
</h2>
<p>Next we apply the cloud masks we just made to the appropriate
vegetation density annual rasters.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The general form of the function is (NOTE the default parameters)</span></span>
<span><span class="co"># cloud_mask(irast, imask, ext = ".tif")</span></span>
<span></span>
<span><span class="co"># We only need to assign the first 2 parameters as the defaults are fine</span></span>
<span><span class="va">irast</span> <span class="op">&lt;-</span> <span class="st">"veg_dens_mskd"</span></span>
<span><span class="va">imask</span> <span class="op">&lt;-</span> <span class="st">"raster_masks/cloud_masks"</span></span>
<span></span>
<span><span class="co"># Run the function</span></span>
<span><span class="fu"><a href="../reference/cloud_mask.html">cloud_mask</a></span><span class="op">(</span><span class="va">irast</span>, <span class="va">imask</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<strong>irast</strong> - input masked veg density rasters
directory.</li>
<li>
<strong>imask</strong> - input cloud masks raster directory.</li>
</ul>
</div>
<div class="section level2">
<h2 id="whats-going-to-happen-now">What’s going to happen now?<a class="anchor" aria-label="anchor" href="#whats-going-to-happen-now"></a>
</h2>
<p>Any annual previously masked veg density rasters that had cloud will
be encoded with a -99 where clouds were and written to the
<code>veg_dens_mskd_cld/</code>. All non-cloudy previously masked veg
density rasters will be copied over to the same directory and
renamed.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bart Huntley.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
